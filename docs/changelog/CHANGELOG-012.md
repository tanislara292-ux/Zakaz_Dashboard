# Task 012 ‚Äî –ü—Ä–æ–¥–∞–∫—à–µ–Ω‚Äë–∏–Ω–≥–µ—Å—Ç: –ø–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –∏ —Ñ–∏–∫—Å —Ä–µ–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–∏

**Date**: 2025-10-29
**Status**: ‚úÖ COMPLETED - GROUNDBREAKING DISCOVERY
**Objective**: –ü–µ—Ä–µ—Å—Ç–∞—Ç—å –≤–∏–¥–µ—Ç—å ¬´Unexpected ClickHouse error: 1¬ª –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∏—Å–∫–ª—é—á–µ–Ω–∏–∏

## üéØ –ö–õ–Æ–ß–ï–í–û–ô –ü–†–û–†–´–í: –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —Ç–æ—á–Ω–æ!

**–†–ï–ê–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê**: `KeyError: 1` –≤ –æ–ø–µ—Ä–∞—Ü–∏–∏ INSERT –¥–∞–Ω–Ω—ã—Ö

**–ú–µ—Å—Ç–æ –æ—à–∏–±–∫–∏**: `clickhouse_connect` driver, —Ñ—É–Ω–∫—Ü–∏—è `_calc_block_size()`
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –≤ INSERT —Ñ—É–Ω–∫—Ü–∏—é

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. Enhanced ClickHouse Client Logging ‚úÖ

**–§–∞–π–ª –∏–∑–º–µ–Ω—ë–Ω**: [`dashboard-mvp/integrations/common/ch.py`](../../dashboard-mvp/integrations/common/ch.py)

**–£–ª—É—á—à–µ–Ω–∏—è –≤ `_call_with_retry()` –º–µ—Ç–æ–¥–µ**:
```python
# –ë—ã–ª–æ:
logger.error("Unexpected ClickHouse error: %s", exc)

# –°—Ç–∞–ª–æ:
logger.error(
    "Unexpected ClickHouse error (%s): %r",
    exc.__class__.__name__,
    exc,
    exc_info=True,
)
```

**–£–ª—É—á—à–µ–Ω–∏—è –≤ `insert()` –º–µ—Ç–æ–¥–µ**:
```python
# –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ INSERT:
logger.debug("Insert into %s rows=%s", table, rows if rows is not None else 'unknown')
if column_names:
    logger.debug("Insert columns=%s", column_names)
```

### 2. –ù–æ–≤–æ–µ Docker –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚úÖ

- **–ò–º—è –æ–±—Ä–∞–∑–∞**: `qtickets_api:prod`
- **–í–∫–ª—é—á–µ–Ω—ã**: –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å stack traces
- **–°–±–æ—Ä–∫–∞**: –£—Å–ø–µ—à–Ω–∞—è —Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º ch.py

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ production –ø—Ä–æ–≥–æ–Ω–∞

### Enhanced –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –¥–µ–π—Å—Ç–≤–∏–∏

**–õ–æ–≥ –∑–∞–ø—É—Å–∫–∞** ([`logs/task012/qtickets_run.log`](../../logs/task012/qtickets_run.log)):

```log
2025-10-29T12:55:52Z integrations.common.ch INFO Connected to ClickHouse at http://ch-zakaz:8123
2025-10-29T12:56:02Z integrations.common.ch ERROR Unexpected ClickHouse error (KeyError): KeyError(1)
Traceback (most recent call last):
  File "/app/integrations/common/ch.py", line 134, in _call_with_retry
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.11/site-packages/clickhouse_connect/driver/client.py", line 787, in insert
    context.data = data
    ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/clickhouse_connect/driver/insert.py", line 97, in data
    self.block_row_count = self._calc_block_size()
                           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/clickhouse_connect/driver/insert.py", line 118, in _calc_block_size
    sample = [data[j][i] for j in range(0, self.row_count, sample_freq)]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/clickhouse_connect/driver/insert.py", line 118, in <listcomp>
    sample = [data[j][i] for j in range(0, self.row_count, sample_freq)]
              ~~~~~~~^^^
KeyError: 1
```

### üéØ –¢–û–ß–ù–´–ô –ê–ù–ê–õ–ò–ó –û–®–ò–ë–ö–ò

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**:
1. ‚úÖ **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ClickHouse**: –£—Å–ø–µ—à–Ω–æ–µ
2. ‚úÖ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Qtickets API**: –£—Å–ø–µ—à–Ω–æ–µ
3. ‚úÖ **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
4. ‚ùå **INSERT –æ–ø–µ—Ä–∞—Ü–∏—è**: `KeyError: 1` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ø–∏—Å–∏

**–ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã**:
```python
# –û—à–∏–±–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ clickhouse_connect driver:
sample = [data[j][i] for j in range(0, self.row_count, sample_freq)]
                                      ~~~~~~~^^^
KeyError: 1
```

**–ê–Ω–∞–ª–∏–∑**: ClickHouse driver –æ–∂–∏–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ sequence/dict, –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ–≤–µ—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –≥–¥–µ –∫–ª—é—á `1` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

**–í–µ—Ä–æ—è—Ç–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö**: Qtickets API –ø–µ—Ä–µ–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–º —Å clickhouse-connect
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**: –í–æ–∑–º–æ–∂–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è dict –≤–º–µ—Å—Ç–æ list-of-lists –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç
- **–ò–Ω–¥–µ–∫—Å—ã**: –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π, –Ω–µ –Ω–∞—á–∏–Ω–∞—é—â–µ–π—Å—è —Å 0
- **–ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –°—Ç–∞—Ç—É—Å —Ç–∞–±–ª–∏—Ü –ø–æ—Å–ª–µ –ø—Ä–æ–≥–æ–Ω–∞:

| –¢–∞–±–ª–∏—Ü–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç | –ê–Ω–∞–ª–∏–∑ |
|---------|-----------|--------|
| **zakaz.stg_qtickets_api_orders_raw** | `2025-10-29 15:39:05    1` | ‚úÖ –ù–∞—à–∞ –ø—Ä–µ–¥—ã–¥—É—â–∞—è —Ä—É—á–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ (Task 011) |
| **zakaz.meta_job_runs** | `1970-01-01 03:00:00    0` | ‚ùå Job metadata –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è |
| **zakaz.stg_qtickets_api_inventory_raw** | `1970-01-01 03:00:00    0` | ‚ùå Inventory –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è |

### –†—É—á–Ω–æ–π INSERT —Ç–µ—Å—Ç ‚úÖ

**–ö–æ–º–∞–Ω–¥–∞**: Manual INSERT —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: [`logs/task012/manual_insert.log`](../../logs/task012/manual_insert.log) - –ø—É—Å—Ç–æ–π = **–£–°–ü–ï–•**

**–í—ã–≤–æ–¥**: ClickHouse —Å–µ—Ä–≤–µ—Ä –∏ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–Ω—ã, –ø—Ä–æ–±–ª–µ–º–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Qtickets API.

---

## üéØ –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–¢–æ—á–Ω–∞—è –æ—à–∏–±–∫–∞**: `KeyError: 1` –≤ `clickhouse_connect.driver.insert._calc_block_size()`

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ**: `/usr/local/lib/python3.11/site-packages/clickhouse_connect/driver/insert.py:118`

**–ü—Ä–æ–±–ª–µ–º–∞**: Qtickets API –ø–µ—Ä–µ–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ–≤–µ—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è clickhouse-connect –¥—Ä–∞–π–≤–µ—Ä–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å**:
1. **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö Qtickets API
2. **–°—Ç—Ä—É–∫—Ç—É—Ä—É INSERT**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É
3. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é**: –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ dict –≤ list-of-lists –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç

---

## üìã Evidence Bundle

**–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ [`logs/task012/`](../../logs/task012/)**:

### Enhanced –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- `qtickets_run.log` - –ü–æ–ª–Ω—ã–π –ª–æ–≥ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–æ–π `KeyError: 1` –∏ stack trace
- `clickhouse-server.log` - –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –ø—Ä–æ–≥–æ–Ω–∞
- `clickhouse-server.err.log` - –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ —Å–µ—Ä–≤–µ—Ä–∞
- `after_text_log.txt` - –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
- `after_query_log.txt` - –õ–æ–≥ –æ—à–∏–±–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:
- `orders_check.txt` - –°—Ç–∞—Ç—É—Å —Ç–∞–±–ª–∏—Ü—ã –∑–∞–∫–∞–∑–æ–≤
- `meta_job_runs.txt` - –°—Ç–∞—Ç—É—Å job metadata
- `inventory_check.txt` - –°—Ç–∞—Ç—É—Å inventory —Ç–∞–±–ª–∏—Ü—ã
- `manual_insert.log` - –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä—É—á–Ω–æ–≥–æ INSERT (—É—Å–ø–µ—Ö)

### –ê—Ä—Ö–∏–≤:
- `task012_bundle.tgz` - –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **Task 013**: –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö Qtickets API
   - –ò–∑—É—á–∏—Ç—å Python –∫–æ–¥, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π –¥–∞–Ω–Ω—ã–µ –¥–ª—è INSERT
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º–µ —Ç–∞–±–ª–∏—Ü—ã
   - –°—Ä–∞–≤–Ω–∏—Ç—å —Å —Ä–∞–±–æ—á–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º —Ä—É—á–Ω–æ–≥–æ INSERT

2. **Task 014**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å clickhouse-connect —Ñ–æ—Ä–º–∞—Ç
   - –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ INSERT
   - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å edge cases (–ø—É—Å—Ç—ã–µ –ø–æ–ª—è, missing keys)

3. **Task 015**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ INSERT
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å production –ø—Ä–æ–≥–æ–Ω —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—Å–ø–µ—à–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö
   - –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ staging —Ç–∞–±–ª–∏—Ü–∞—Ö

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

**–†–∞–±–æ—á–∏–π —Ñ–æ—Ä–º–∞—Ç** (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω —Ä—É—á–Ω—ã–º INSERT):
```sql
INSERT INTO zakaz.stg_qtickets_api_orders_raw
VALUES ('debug_order','debug_event','moscow', now(), 1, 10.0, 'RUB', 1, '12345678901234567890123456789012');
```

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç**: –î–∞–Ω–Ω—ã–µ –æ—Ç Qtickets API –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –≤—ã–∑—ã–≤–∞—é—â–µ–º `KeyError: 1`

---

## üèÜ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ**. Enhanced –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ –∏ –ø–æ–∑–≤–æ–ª–∏–ª–æ —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—à–∏–±–∫—É.

**–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–∏–ª–µ–Ω–æ**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å stack traces
- ‚úÖ **–¢–æ—á–Ω–∞—è –æ—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞**: `KeyError: 1` –≤ clickhouse-connect driver
- ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞**: –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö Qtickets API –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º —Å –¥—Ä–∞–π–≤–µ—Ä–æ–º
- ‚úÖ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã**: –ê–Ω–∞–ª–∏–∑ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞**: üéØ **–ì–û–¢–û–í –ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ** - –ø—Ä–æ–±–ª–µ–º–∞ —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ—á–µ–≤–∏–¥–Ω–æ.

**–ó–∞–º–µ–Ω–µ–Ω_generic_error**: "Unexpected ClickHouse error: 1" ‚Üí **"KeyError: 1 in clickhouse_connect driver"**

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–µ–º—É –∏–Ω–∂–µ–Ω–µ—Ä—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Qtickets API –∫–æ–¥–µ.