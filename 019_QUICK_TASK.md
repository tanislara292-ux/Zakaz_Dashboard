# –ö–†–ê–¢–ö–ê–Ø –ó–ê–î–ê–ß–ê –î–õ–Ø –ö–û–î–ï–†–ê - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–∫–∞–∑—á–∏–∫—É.

## üìÅ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å (3 —Ñ–∞–π–ª–∞):

### 1. –°–æ–∑–¥–∞—Ç—å `scripts/validate_clickhouse_schema.py`
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:** –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ö–µ–º—ã ClickHouse
**–û—Ç–∫—É–¥–∞ –≤–∑—è—Ç—å –∏–¥–µ–∏:**
- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å `REQUIRED_TABLES` –≤ `scripts/bootstrap_clickhouse.sh` (—Å—Ç—Ä–æ–∫–∏ 101-109)
- –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `bootstrap_roles_grants.sql`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ `integrations/common/ch.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –∏–∑ REQUIRED_TABLES
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin, etl_writer, datalens_reader, backup_user)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å view definitions

### 2. –°–æ–∑–¥–∞—Ç—å `.github/workflows/ci.yml`
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:** GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
**–û—Ç–∫—É–¥–∞ –≤–∑—è—Ç—å –∏–¥–µ–∏:**
- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `.github/workflows/etl_dispatch.yml` –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ò–∑—É—á–∏—Ç—å —à–∞–≥–∏ –≤ `docs/DEPLOYMENT.md` (—Ä–∞–∑–¥–µ–ª Testing & CI)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ CHANGELOG-015.md

**–®–∞–≥–∏:**
- Checkout –∫–æ–¥–∞
- Setup Python —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏–∑ `integrations/qtickets_api/requirements.txt`
- –ó–∞–ø—É—Å–∫ `scripts/validate_clickhouse_schema.py`
- –ó–∞–ø—É—Å–∫ `pytest integrations/qtickets_api/tests/`
- –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ `integrations/qtickets_api/Dockerfile`

### 3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å inventory –≤ `integrations/qtickets_api/client.py`
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:** –ó–∞–º–µ–Ω–∏—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
**–û—Ç–∫—É–¥–∞ –≤–∑—è—Ç—å –∏–¥–µ–∏:**
- –ò–∑—É—á–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã `list_events()` –∏ `fetch_orders_get()`
- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å `inventory_agg.py` –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã retry –∏ error handling –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

**–ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- `list_shows(event_id)` - –ø–æ–ª—É—á–∏—Ç—å shows –¥–ª—è —Å–æ–±—ã—Ç–∏—è
- `fetch_inventory_snapshot()` - –ø–æ–ª–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç inventory
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `get_seats(show_id)` –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

```bash
# 1. Bootstrap ClickHouse
cd dashboard-mvp/infra/clickhouse
../../scripts/bootstrap_clickhouse.sh

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä
python scripts/validate_clickhouse_schema.py

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
pytest integrations/qtickets_api/tests/ -v

# 4. –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑
docker build -f integrations/qtickets_api/Dockerfile -t test .

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Qtickets loader
./scripts/smoke_qtickets_dryrun.sh --env-file secrets/.env.qtickets_api
```

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
- –í—Å–µ 3 —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- Bootstrap –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- Docker –æ–±—Ä–∞–∑ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
- Qtickets loader —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ dry-run —Ä–µ–∂–∏–º–µ

## üìã –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã:
1. –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É `fix/019-missing-critical-files`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `scripts/validate_clickhouse_schema.py`
3. –°–æ–∑–¥–∞—Ç—å `.github/workflows/ci.yml`
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å inventory –º–µ—Ç–æ–¥—ã –≤ `client.py`
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –≤–º–µ—Å—Ç–µ
6. –°–¥–µ–ª–∞—Ç—å PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ì–æ—Ç–æ–≤–æ! –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∑–∞–∫–∞–∑—á–∏–∫—É.**