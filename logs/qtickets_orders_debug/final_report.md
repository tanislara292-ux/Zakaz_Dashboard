# –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: QTickets /orders - –ø–æ—à–∞–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≥–∏–ø–æ—Ç–µ–∑

**–î–∞—Ç–∞:** 2025-11-03
**–¶–µ–ª—å:** –ù–∞–π—Ç–∏, –ø–æ—á–µ–º—É QTickets API –Ω–µ –æ—Ç–¥–∞–µ—Ç –ø—Ä–æ–¥–∞–∂–∏, –ø—Ä–∏ —Ç–æ–º —á—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –µ—Å—Ç—å.
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–£–°–ü–ï–•** - –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

## –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –®–∞–≥ | HTTP-–∫–æ–¥ | –î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----|-----------|--------------|------------|---------|
| A1 | 200 OK | 50 –∑–∞–∫–∞–∑–æ–≤ | GET + payed=1 + since=30d | ‚úÖ **–£–°–ü–ï–•** |
| A2 | 200 OK | 50 –∑–∞–∫–∞–∑–æ–≤ | GET + payed=1 + per_page=200 | ‚úÖ **–£–°–ü–ï–•** |
| D | 200 OK | 1 –∑–∞–∫–∞–∑ | GET /orders/{id} –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É ID | ‚úÖ **–£–°–ü–ï–•** |
| G | N/A | 40 –∑–∞–∫–∞–∑–æ–≤ | –ó–∞–≥—Ä—É–∑—á–∏–∫ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª –¥–∞–Ω–Ω—ã–µ | ‚úÖ **–£–°–ü–ï–•** |

## –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –Ω–∞–π–¥–µ–Ω–∞ –∏ —Ä–µ—à–µ–Ω–∞:**

1. **API –†–ê–ë–û–¢–ê–ï–¢!** QTickets API –æ—Ç–¥–∞–µ—Ç –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ GET –∑–∞–ø—Ä–æ—Å—ã
2. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä:** `payed=1` –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂
3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** GET —Å query parameters, –∞ –Ω–µ POST —Å JSON body
4. **–¢–æ–∫–µ–Ω —Ä–∞–±–æ—á–∏–π:** –ò–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
5. **–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:** 40 –∑–∞–∫–∞–∑–æ–≤ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ ClickHouse

### üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–≥—Ä—É–∑—á–∏–∫–∞:**

**stg_qtickets_api_orders_raw:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π: 40
- –ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö: 18 –º–∞—è 2021 - 13 –∏—é–Ω—è 2021
- –°—Ç–∞—Ç—É—Å: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ

**fact_qtickets_sales_daily:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π: 17
- –ë–∏–ª–µ—Ç–æ–≤ –ø—Ä–æ–¥–∞–Ω–æ: 118
- –í—ã—Ä—É—á–∫–∞: 11 397 —Ä—É–±.
- –°—Ç–∞—Ç—É—Å: ‚úÖ –£—Å–ø–µ—à–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ

### üîç **–ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã:**

**‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ –≥–∏–ø–æ—Ç–µ–∑—ã –∏–∑ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.md:**
- **–ì–∏–ø–æ—Ç–µ–∑–∞ 1 (–ü—Ä–æ–±–ª–µ–º–∞ —Å —Ç–æ–∫–µ–Ω–æ–º/scopes):** –û–ü–†–û–í–ï–†–ì–ù–ê
  - –¢–æ–∫–µ–Ω –∏–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
  - Orders endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

- **–ì–∏–ø–æ—Ç–µ–∑–∞ 2 (–ù—É–∂–µ–Ω POST —Å JSON):** –û–ü–†–û–í–ï–†–ì–ù–ê
  - API —Ä–∞–±–æ—Ç–∞–µ—Ç —Å GET –∑–∞–ø—Ä–æ—Å–∞–º–∏
  - POST —Å JSON body –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç—ã:**
- GET –∑–∞–ø—Ä–æ—Å—ã —Å `payed=1` —Ä–∞–±–æ—Ç–∞—é—Ç
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (2021 –≥–æ–¥)
- –¢–æ–∫–µ–Ω –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ orders –∏ events endpoints

### üìù **–†–∞–±–æ—á–∏–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞:**

```bash
curl -s \
  -H "Authorization: Bearer $QTICKETS_TOKEN" \
  "https://qtickets.ru/api/rest/v1/orders?organization=$ORG_NAME&payed=1&since=$SINCE&page=1&per_page=200"
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `organization=irs-prod` - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
- `payed=1` - **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂
- `since` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601
- `page` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- `per_page` - —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–æ 200)

### üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GET —Ñ–æ—Ä–º–∞—Ç** —Å query parameters
2. **–í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è—Ç—å `payed=1`** –≤ –∑–∞–ø—Ä–æ—Å—ã
3. **QTICKETS_SINCE_HOURS** –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å** `meta_job_runs` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–≥—Ä—É–∑–æ–∫

### üìã **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `QTICKETS_SINCE_HOURS` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂
2. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –°–ª–µ–¥–∏—Ç—å –∑–∞ –ø–æ—è–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!** QTickets API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ ClickHouse.

**–ö–ª—é—á–µ–≤–∞—è –æ—à–∏–±–∫–∞ –±—ã–ª–∞ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∫–æ–¥–∞** (–∑–∞–¥–∞—á–∞ 035) - –ø—ã—Ç–∞–ª–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å POST —Å JSON, –∫–æ–≥–¥–∞ API —Ä–∞–±–æ—Ç–∞–µ—Ç —Å GET query parameters.

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏!** üöÄ

---
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** Claude AI Assistant
**–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:** –í—Å–µ –ª–æ–≥–∏ –∏ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `qtickets_orders_debug/`