# –ü–û–õ–ù–´–ô –ü–ê–ö–ï–¢ –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø ZAKAZ DASHBOARD –î–õ–Ø –ó–ê–ö–ê–ó–ß–ò–ö–ê

## –û–±–∑–æ—Ä

–î–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã Zakaz Dashboard –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–∫–∞–∑—á–∏–∫–∞. –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —à–∞–≥–∏, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º.

---

## –°–û–î–ï–†–ñ–ê–ù–ò–ï –ü–ê–ö–ï–¢–ê

### üìã –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

1. **[021_UBUNTU_DEPLOYMENT_GUIDE.md](021_UBUNTU_DEPLOYMENT_GUIDE.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Ubuntu
2. **[022_MIGRATION_GUIDE.md](022_MIGRATION_GUIDE.md)** - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞
3. **[023_DATALENS_SETUP_GUIDE.md](023_DATALENS_SETUP_GUIDE.md)** - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex DataLens
4. **[024_COMPREHENSIVE_TROUBLESHOOTING_GUIDE.md](024_COMPREHENSIVE_TROUBLESHOOTING_GUIDE.md)** - –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º

### üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

5. **[019_FINAL_VERIFICATION_REPORT.md](019_FINAL_VERIFICATION_REPORT.md)** - –û—Ç—á–µ—Ç –æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã
6. **[020_QTICKETS_PRODUCTION_TESTING.md](020_QTICKETS_PRODUCTION_TESTING.md)** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ QTickets API
7. **[019_PRODUCTION_TESTING_PLAN.md](019_PRODUCTION_TESTING_PLAN.md)** - –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ –î–õ–Ø –ó–ê–ö–ê–ó–ß–ò–ö–ê

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (15 –º–∏–Ω—É—Ç)

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
sudo mkdir -p /opt/zakaz_dashboard
sudo chown $USER:$USER /opt/zakaz_dashboard
cd /opt/zakaz_dashboard
git clone https://github.com/tanislara292-ux/Zakaz_Dashboard.git .
git checkout main
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ClickHouse (10 –º–∏–Ω—É—Ç)

```bash
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é ClickHouse
cd dashboard-mvp/infra/clickhouse

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp .env.example .env
nano .env  # –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

# –ó–∞–ø—É—Å–∫ ClickHouse
docker-compose up -d

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã
cd ../..
bash scripts/bootstrap_clickhouse.sh
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ (5 –º–∏–Ω—É—Ç)

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å–µ–∫—Ä–µ—Ç–æ–≤
mkdir -p secrets

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ QTickets API
nano secrets/.env.qtickets_api
# –í—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VK Ads
nano secrets/.env.vk
# –í—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω VK

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç
nano secrets/.env.direct
# –í—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –Ø–Ω–¥–µ–∫—Å–∞
```

### –®–∞–≥ 4: –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ (10 –º–∏–Ω—É—Ç)

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -f dashboard-mvp/integrations/qtickets_api/Dockerfile -t qtickets_api:latest .

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd —é–Ω–∏—Ç–æ–≤
sudo cp dashboard-mvp/ops/systemd/*.service /etc/systemd/system/
sudo cp dashboard-mvp/ops/systemd/*.timer /etc/systemd/system/
sudo systemctl daemon-reload

# –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–æ–≤
sudo systemctl enable --now qtickets_api.timer
sudo systemctl enable --now vk_ads.timer
sudo systemctl enable --now direct.timer
```

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS (5 –º–∏–Ω—É—Ç)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Caddy
sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https
curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable.gpg
echo "deb [signed-by=/usr/share/keyrings/caddy-stable.gpg] https://dl.cloudsmith.io/public/caddy/stable/deb/debian any-version main" | sudo tee /etc/apt/sources.list.d/caddy-stable.list
sudo apt update
sudo apt install caddy -y

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Caddyfile
sudo nano /etc/caddy/Caddyfile
# –í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è bi.zakaz-dashboard.ru

# –ó–∞–ø—É—Å–∫ Caddy
sudo systemctl enable --now caddy
```

### –®–∞–≥ 6: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ DataLens (10 –º–∏–Ω—É—Ç)

1. –û—Ç–∫—Ä—ã—Ç—å https://datalens.yandex.ru/
2. –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ClickHouse:
   - –•–æ—Å—Ç: `bi.zakaz-dashboard.ru`
   - –ü–æ—Ä—Ç: `443`
   - –ë–∞–∑–∞: `zakaz`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: `datalens_reader`
   - –ü–∞—Ä–æ–ª—å: `ChangeMe123!`
3. –°–æ–∑–¥–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∞—à–±–æ—Ä–¥—ã

---

## üìã –ü–û–õ–ù–´–ô –ß–ï–ö-–õ–ò–°–¢ –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø

### ‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [ ] **–°–µ—Ä–≤–µ—Ä**: Ubuntu 20.04+ —Å 4+ CPU, 8GB+ RAM, 100GB+ SSD
- [ ] **–°–µ—Ç—å**: –û—Ç–∫—Ä—ã—Ç—ã –ø–æ—Ä—Ç—ã 80, 443, –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ–º–µ–Ω
- [ ] **–î–æ—Å—Ç—É–ø**: SSH —Å –ø—Ä–∞–≤–∞–º–∏ sudo
- [ ] **–¢–æ–∫–µ–Ω—ã**: –ü–æ–ª—É—á–µ–Ω—ã API —Ç–æ–∫–µ–Ω—ã QTickets, VK Ads, –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç

### ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

- [ ] **Docker**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] **Docker Compose**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] **Git**: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- [ ] **–ü—Ä–∞–≤–∞**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º

### ‚úÖ ClickHouse

- [ ] **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: `.env` —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: –ó–∞–ø—É—â–µ–Ω –∏ –∑–¥–æ—Ä–æ–≤
- [ ] **–°—Ö–µ–º–∞**: –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ —á–µ—Ä–µ–∑ `bootstrap_clickhouse.sh`
- [ ] **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: –°–æ–∑–¥–∞–Ω—ã admin, etl_writer, datalens_reader
- [ ] **–¢–∞–±–ª–∏—Ü—ã**: –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### ‚úÖ –°–µ–∫—Ä–µ—Ç—ã –∏ —Ç–æ–∫–µ–Ω—ã

- [ ] **QTickets API**: `.env.qtickets_api` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] **VK Ads**: `.env.vk` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] **–Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç**: `.env.direct` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] **–ü—Ä–∞–≤–∞**: –§–∞–π–ª—ã —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∞ 600

### ‚úÖ –°–µ—Ä–≤–∏—Å—ã

- [ ] **Docker –æ–±—Ä–∞–∑**: qtickets_api —Å–æ–±—Ä–∞–Ω
- [ ] **–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫**: Dry-run —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] **Systemd —é–Ω–∏—Ç—ã**: –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω—ã
- [ ] **–¢–∞–π–º–µ—Ä—ã**: –í–∫–ª—é—á–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

### ‚úÖ HTTPS –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

- [ ] **Caddy**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**: –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –¥–æ–º–µ–Ω–∞
- [ ] **HTTPS –¥–æ—Å—Ç—É–ø**: ClickHouse –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS
- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞**: `curl -k https://bi.zakaz-dashboard.ru/?query=SELECT%201` —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ DataLens

- [ ] **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–æ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
- [ ] **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**: –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- [ ] **–î–∞—Ç–∞—Å–µ—Ç—ã**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
- [ ] **–î–∞—à–±–æ—Ä–¥—ã**: –°–æ–∑–¥–∞–Ω—ã –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
- [ ] **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 15 –º–∏–Ω—É—Ç

### ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- [ ] **–ê–ª–µ—Ä—Ç—ã**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
- [ ] **–ë—ç–∫–∞–ø—ã**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
- [ ] **–ü—Ä–æ–≤–µ—Ä–∫–∏**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–û–ù–ù–´–ï –§–ê–ô–õ–´

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### ClickHouse (.env)
```bash
CLICKHOUSE_ADMIN_USER=admin
CLICKHOUSE_ADMIN_PASSWORD=–°–ú–ï–ù–ò–¢–ï_–≠–¢–û–¢_–ü–ê–†–û–õ–¨
CLICKHOUSE_DB=zakaz
CLICKHOUSE_TZ=Europe/Moscow
```

#### QTickets API (.env.qtickets_api)
```bash
QTICKETS_BASE_URL=https://qtickets.ru/api/rest/v1
QTICKETS_TOKEN=–í–ê–®_–ë–û–ï–í–û–ô_–¢–û–ö–ï–ù
CLICKHOUSE_HOST=localhost
CLICKHOUSE_USER=etl_writer
CLICKHOUSE_PASSWORD=EtL2024!Strong#Pass
DRY_RUN=false
```

#### VK Ads (.env.vk)
```bash
VK_ACCESS_TOKEN=–í–ê–®_VK_–¢–û–ö–ï–ù
VK_ACCOUNT_ID=–í–ê–®_ACCOUNT_ID
CLICKHOUSE_HOST=localhost
CLICKHOUSE_USER=etl_writer
```

#### –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç (.env.direct)
```bash
DIRECT_CLIENT_ID=–í–ê–®_CLIENT_ID
DIRECT_CLIENT_SECRET=–í–ê–®_CLIENT_SECRET
DIRECT_TOKEN=–í–ê–®_–Ø–ù–î–ï–ö–°_–¢–û–ö–ï–ù
CLICKHOUSE_HOST=localhost
```

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –®–ê–ì–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```bash
# –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ClickHouse
docker exec ch-zakaz clickhouse-client --user=admin --password='admin_pass' -q "
ALTER USER admin IDENTIFIED BY '–ù–û–í–´–ô_–°–ò–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨'"

# –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å DataLens –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
docker exec ch-zakaz clickhouse-client --user=admin --password='–ù–û–í–´–ô_–ü–ê–†–û–õ–¨' -q "
ALTER USER datalens_reader IDENTIFIED BY '–ù–û–í–´–ô_–ü–ê–†–û–õ–¨_DATALENS'"
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞

```bash
# –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### 3. –ó–∞—â–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤
chmod 600 /opt/zakaz_dashboard/secrets/.env*
chown $USER:$USER /opt/zakaz_dashboard/secrets/.env*

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ .gitignore
echo "secrets/" >> .gitignore
echo "*.env" >> .gitignore
```

---

## üìä –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–ò

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (5 –º–∏–Ω—É—Ç)

```bash
# –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
cd /opt/zakaz_dashboard
bash dashboard-mvp/ops/system_check.sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
docker exec ch-zakaz clickhouse-client --user=datalens_reader --password='ChangeMe123!' -q "
SELECT 
    'Data Check' as metric,
    count() as rows,
    max(sale_ts) as latest
FROM zakaz.stg_qtickets_api_orders_raw 
WHERE sale_ts >= today() - INTERVAL 1 DAY"
```

### –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (30 –º–∏–Ω—É—Ç)

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ç–∞–π–º–µ—Ä—ã**: `systemctl list-timers`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤**: `journalctl -u qtickets_api.service -n 20`
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ ClickHouse**: –ß–µ—Ä–µ–∑ DataLens –∏–ª–∏ CLI
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTTPS –¥–æ—Å—Ç—É–ø**: –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ curl
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–ª–µ—Ä—Ç—ã**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å email –∏ —Ç–∞–±–ª–∏—Ü—É –∞–ª–µ—Ä—Ç–æ–≤

---

## üÜò –ü–û–î–î–ï–†–ñ–ö–ê –ò –ö–û–ù–¢–ê–ö–¢–´

### –£—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

| –ü—Ä–æ–±–ª–µ–º–∞ | –ö–æ–Ω—Ç–∞–∫—Ç—ã | –í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ |
|-----------|-----------|--------------|
| **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | –î–∞–Ω–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ | –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ |
| **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞: [–∫–æ–Ω—Ç–∞–∫—Ç] | 4 —á–∞—Å–∞ |
| **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–±–æ–∏** | –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç: [–∫–æ–Ω—Ç–∞–∫—Ç] | 30 –º–∏–Ω—É—Ç |

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
bash dashboard-mvp/ops/system_check.sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl restart qtickets_api.service

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
journalctl -u qtickets_api.service -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–π–º–µ—Ä–æ–≤
systemctl list-timers

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats
htop
df -h
```

---

## üìö –ü–û–õ–ï–ó–ù–´–ï –†–ï–°–£–†–°–´

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–û—Å–Ω–æ–≤–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ**: [021_UBUNTU_DEPLOYMENT_GUIDE.md](021_UBUNTU_DEPLOYMENT_GUIDE.md)
- **–ú–∏–≥—Ä–∞—Ü–∏—è**: [022_MIGRATION_GUIDE.md](022_MIGRATION_GUIDE.md)
- **DataLens**: [023_DATALENS_SETUP_GUIDE.md](023_DATALENS_SETUP_GUIDE.md)
- **Troubleshooting**: [024_COMPREHENSIVE_TROUBLESHOOTING_GUIDE.md](024_COMPREHENSIVE_TROUBLESHOOTING_GUIDE.md)

### SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è DataLens

```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏
SELECT 
    event_date,
    city,
    event_name,
    tickets_sold,
    revenue,
    (revenue - refunds_amount) AS net_revenue
FROM zakaz.v_qtickets_sales_latest
WHERE event_date >= today() - INTERVAL 30 DAY

-- –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
SELECT 
    d AS event_date,
    city,
    spend_total,
    net_revenue,
    romi
FROM zakaz.v_marketing_daily
WHERE d >= today() - INTERVAL 30 DAY

-- –°–≤–µ–∂–µ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
SELECT 
    source,
    table_name,
    latest_date,
    days_behind
FROM zakaz.v_qtickets_freshness
```

---

## ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ò–ï –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Ø

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

1. ‚úÖ **–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞** –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞
2. ‚úÖ **–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è** –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
3. ‚úÖ **DataLens –ø–æ–¥–∫–ª—é—á–µ–Ω** –∏ –¥–∞—à–±–æ—Ä–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
4. ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω** –∏ –∞–ª–µ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
5. ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞** –Ω–∞ –±–∞–∑–æ–≤–æ–º —É—Ä–æ–≤–Ω–µ

### –ü–µ—Ä–µ–¥–∞—á–∞ –∑–∞–∫–∞–∑—á–∏–∫—É

1. **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –¥–æ—Å—Ç—É–ø—ã**:
   - URL –¥–∞—à–±–æ—Ä–¥–æ–≤ DataLens
   - –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
   - –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏

2. **–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ**:
   - –†–∞–±–æ—Ç–∞ —Å –¥–∞—à–±–æ—Ä–¥–∞–º–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
   - –ß—Ç–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

3. **–ü–µ—Ä–µ–¥–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**:
   - –î–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
   - –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

---

## üìà –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò –†–ê–ó–í–ò–¢–ò–Ø

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-3 –º–µ—Å—è—Ü–∞)

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤ –Ω–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –æ–±–ª–∞–∫–æ

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (3-6 –º–µ—Å—è—Ü–µ–≤)

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Prometheus/Grafana)
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (6+ –º–µ—Å—è—Ü–µ–≤)

- –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä ClickHouse
- –í–Ω–µ–¥—Ä–µ–Ω–∏–µ ML-–º–æ–¥–µ–ª–µ–π –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM-—Å–∏—Å—Ç–µ–º–∞–º–∏

---

**–í–µ—Ä—Å–∏—è –ø–∞–∫–µ—Ç–∞**: 1.0.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: $(date +%Y-%m-%d)  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: $(date +%Y-%m-%d)

---

*–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã Zakaz Dashboard. –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –ø–æ–¥—Ä–æ–±–Ω—ã–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞–º –∏–ª–∏ –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏.*